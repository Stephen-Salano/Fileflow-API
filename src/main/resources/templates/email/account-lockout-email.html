<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Alert: Account Locked</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #333333;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }
        .container {
            background-color: #f9f9f9;
            border: 1px solid #e3e3e3;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 20px;
            border-bottom: 1px solid #e3e3e3;
            padding-bottom: 10px;
        }
        .header h1 {
            color: #d9534f; /* Alert color */
        }
        .security-details {
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            margin: 20px 0;
        }
        .security-details li {
            list-style-type: none;
            padding: 5px 0;
        }
        .footer {
            margin-top: 30px;
            font-size: 12px;
            color: #777777;
            text-align: center;
        }
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1 th:text="${appName}">FileFlow</h1>
        <h2>Security Alert: Account Locked</h2>
    </div>

    <p>Hello <strong th:text="${name}">User</strong>,</p>

    <p>Your <strong th:text="${appName}">FileFlow</strong> account has been temporarily locked as a security precaution due to multiple failed login attempts.</p>

    <div class="security-details">
        <p><strong>Details of the final failed attempt:</strong></p>
        <ul>
            <li><strong>Time:</strong> <span th:text="${lockoutTime}">[Date & Time]</span></li>
            <li><strong>IP Address:</strong> <span th:text="${securityContext.ipAddress}">[IP Address]</span></li>
            <li><strong>Browser:</strong> <span th:text="${securityContext.browser}">[Browser]</span></li>
            <li><strong>Operating System:</strong> <span th:text="${securityContext.os}">[OS]</span></li>
        </ul>
    </div>

    <p><strong>To unlock your account, you must reset your password.</strong></p>
    <p>If you did not make these login attempts, we strongly recommend you secure your account immediately by clicking the link below. If these attempts were made by you, you can use the same link to regain access.</p>

    <p style="text-align: center; margin: 30px 0;">
        <a th:href="${resetUrl}" style="background-color: #007bff; color: white; padding: 12px 25px; text-decoration: none; border-radius: 5px; font-weight: bold;">Reset Your Password</a>
    </p>

    <p>Best regards,<br>The <span th:text="${appName}">FileFlow</span> Team</p>

    <div class="footer">
        <p>&copy; <span th:text="${#temporals.format(#temporals.createNow(), 'yyyy')}">2025</span> <span th:text="${appName}">FileFlow</span>. All rights reserved.</p>
    </div>
</div>
</body>
</html>